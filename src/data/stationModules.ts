import { StationModule, StationState } from "../types";
import { subtractWithFloor } from "../utils";

export const baseModule: StationModule = {
    name: "Prototype Module",
    description: "Module defaults",
    rarity: -1,
    power: 0,
    air: 0,
    food: 0,
    credits: 0,
    morale: 0,
    crewRequired: 0,
    crewApplied: 0,
    powerStorage: 0,
    airStorage: 0,
    foodStorage: 0,
    creditPurchaseCost: -1,
    dockingPorts: 0,
    vesselAttraction: 0,
    mutateStation: function(stationState: Partial<StationState>): Partial<StationState> {
      return stationState;
    },
    fold: function (props: Partial<StationModule>): StationModule {
      return { ...this, ...props };
    },
    foldAndCombine: function (fn: (state: StationModule) => Partial<StationModule>): StationModule {
      return { ...this, ...fn(this)};
    },
    foldAndCombineAsync: function (fn: (state: StationModule) => Partial<StationModule>): StationModule {
      return { ...this, ...fn(this)};
    },
}

export const stationModules: StationModule[] = [
    {
      ...baseModule,
      name: "Command Module",
      description: "The command center of the station",
      rarity: -1,
      power: -2,
      crewRequired: 3,
      crewApplied: 3,
      powerStorage: 20,
      airStorage: 20,
      foodStorage: 20,
      creditPurchaseCost: -1,
      dockingPorts: 2,
      vesselAttraction: 5,
      // mutateStation: (stationState) => {
      //   return { power: subtractWithFloor(stationState.power, 2, 0) }
      // }
    },
    {
      ...baseModule,
      name: "Reactor",
      description: "Fusion reactor",
      rarity: 8,
      power: 10,
      crewRequired: 2,
      crewApplied: 2,
      creditPurchaseCost: 10000,
      vesselAttraction: 5,
    },
    {
      ...baseModule,
      name: "Crew Quarters",
      description: "Barracks, mess hall, gravity ring, food and air storage",
      rarity: .3,
      power: -5,
      morale: 2,
      airStorage: 100,
      foodStorage: 100,
      creditPurchaseCost: 5000,
    },
    {
      ...baseModule,
      name: "Battery Bank",
      description: "HoshiCorp Standard Issue Red Lithium Battery Bank",
      rarity: 10,
      power: 0,
      powerStorage: 100,
      creditPurchaseCost: 2000,
    },
    {
      ...baseModule,
      name: "Air Recycler",
      description: "HoshiCorp Air Recycler. Recycles the air for five crew",
      rarity: 10,
      power: -3,
      air: 5,
      creditPurchaseCost: 2000,
    },
    {
      ...baseModule,
      name: "MIE Shield",
      description: "ZeissMod Magneto-Ionospheric Energy field. Protect the station from certain phenomena and projectiles",
      rarity: 12,
      power: -5,
      creditPurchaseCost: 2000,
      vesselAttraction: 1,
    },
    {
      ...baseModule,
      name: "Utility Module",
      description: "ZeissMod. A little of everything",
      rarity: 15,
      power: 1,
      air: 1,
      food: 1,
      powerStorage: 50,
      airStorage: 50,
      foodStorage: 100,
      creditPurchaseCost: 2000,
      vesselAttraction: 1,
    },
    {
      ...baseModule,
      name: "Docking Port",
      description: "ZeissMod Docking Port",
      rarity: 5,
      dockingPorts: 1,
      creditPurchaseCost: 2000,
      vesselAttraction: 1,
    },
    {
      ...baseModule,
      name: "Docking Umbilical",
      description: "GDM (Used). A well-used manually operated docking umbilical",
      rarity: 2,
      power: -2,
      crewRequired: 1,
      dockingPorts: 1,
      creditPurchaseCost: 500,
      vesselAttraction: 1,
    },
    {
      ...baseModule,
      name: "Flywheel Power Storage",
      description: "GDM Flywheel Power Storage. Sacrifices some efficiency for cheap and reliable power storage",
      rarity: 14,
      power: -1,
      powerStorage: 150,
      creditPurchaseCost: 200,
    },
    {
      ...baseModule,
      name: "RCS Stabilizer",
      description: "GDM RCS Stabilization Thrusters. Allows fine-grained station orbit control",
      rarity: 14,
      power: -2,
      crewRequired: 1,
      creditPurchaseCost: 250,
    },
    {
      ...baseModule,
      name: "Capsule Hotel",
      description: "HoshiCorp Automated Capsule Hotel. Makes visitors happy",
      rarity: 12,
      power: -10,
      morale: 5,
      crewRequired: 0,
      creditPurchaseCost: 2000,
      vesselAttraction: 10,
    },
  ];